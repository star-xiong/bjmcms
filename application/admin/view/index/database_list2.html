<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="__STATIC__plug/layui/css/layui.css" />
		<script type="text/javascript" src="__STATIC__common/js/jquery-3.3.1.min.js"></script>
		<style type="text/css">
			body {
				padding: 10px 30px;
			}

			.hide {
				display: none
			}
		</style>
	</head>
	<body>
		<span id="datas" style="display:none;">{$data}</span>
		<button class="layui-btn layui-btn-primary up-all">全部收起</button>
		<button class="layui-btn layui-btn-primary down-all">全部展开</button>

		<div class="test-tree-table" lay-filter="test1"></div>

		<script type="text/javascript" src="__STATIC__plug/layui/layui.js"></script>
		<script type="text/javascript">
			layui.config({
				base: '__STATIC__tabletree/js/',
				version: "2.0.1-simple"
			})
			layui.use(['treetable', 'form'], function() {
				var arr = $('#datas').html();
				var data = JSON.parse(arr);
				console.log(data);
				var data1 = [{
						"id": "20180309122333",
						"pid": 0,
						"filename": "1-1",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": "20180712130923",
						"pid": 0,
						"filename": "1-2",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 3,
						"pid": 0,
						"filename": "1-3",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 4,
						"pid": "20180309122333",
						"filename": "1-1-1",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 5,
						"pid": "20180309122333",
						"filename": "1-1-2",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 6,
						"pid": "20180712130923",
						"filename": "1-2-1",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 7,
						"pid": "20180712130923",
						"filename": "1-2-3",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 8,
						"pid": 3,
						"filename": "1-3-1",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 9,
						"pid": 3,
						"filename": "1-3-2",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 10,
						"pid": 4,
						"filename": "1-1-1-1",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					},
					{
						"id": 11,
						"pid": 4,
						"filename": "1-1-1-2",
						"filesize": 2,
						"maketime": "2018-03-09 12:23:33"
					}
				];
				console.log(data1)
				var o = layui.$,
					treetable = layui.treetable;
				treetable.render({
					elem: '.test-tree-table',
					data: data,
					field: 'filename',
					cols: [{
							field: 'filename',
							title: '文件名称',
							width: '20%',
						},
						{
							field: 'id',
							title: 'ID',
							width: '5%',
						},
						{
							field: 'pid',
							title: '父ID',
							width: '5%',
						},
						{
							field: 'filesize',
							title: '文件大小',
							width: '10%',
						},
						{
							field: 'maketime',
							title: '备份时间',
							width: '15%',
						},
						{
							field: 'actions',
							title: '操作',
							width: '20%',
							data: [
								'<a lay-filter="add" href="1.html">添加</a>', '<a lay-filter="edit">编辑</a>',
							],
						},
					]
				});

				treetable.on('treetable(test1)', function(data) {
					console.dir(o(data.elem).html());
				})

				treetable.on('treetable(add)', function(data) {
					console.dir(data);
				})

				treetable.on('treetable(edit)', function(data) {
					console.dir(data);
				})

				o('.up-all').click(function() {
					treetable.all('up');
				})

				o('.down-all').click(function() {
					treetable.all('down');
				})
			})
		</script>
	</body>
</html>
